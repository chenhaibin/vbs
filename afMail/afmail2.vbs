
subEmailUser "adrian@nofishhere.com", "test data"

' *****************************************************************************
' * Subroutine to send mail with password to user
' *****************************************************************************

sub subEmailUser (strEmail, strData)


    ' *************************************************************************
    ' * Dim object, strings etc..
    ' *************************************************************************
    Dim objMail

    ' *************************************************************************
    ' * Grab an instance of the CDONTS mail object (only available with IIS/ASP)
    ' *************************************************************************
    set objMail = createobject("CDONTS.NewEmail")
  
    ' *************************************************************************
    ' * Set the from address, so user can email that user for issues.
    ' *************************************************************************  
    objMail.From = "adrianfarnell@hbosplc.com"
    
    ' *************************************************************************
    ' * email address to send the user details
    ' *************************************************************************    
    objMail.To = strEmail
    
    ' *************************************************************************
    ' * Set the subject line of the email
    ' *************************************************************************    
    objMail.Subject = "ECAS HSDL Agent user password details"
    
    ' *************************************************************************
    ' * Write the body of the email.
    ' *************************************************************************    
    objMail.Body = "Your ECAS password is " & strData & ".  You username will be HSDL followed by your staff id e.g. hsdl123456."

    ' *************************************************************************
    ' * Setup error catching
    ' *************************************************************************
    on error resume next
    
    ' *************************************************************************
    ' * clear our error object
    ' *************************************************************************    
    err.Clear

    ' *************************************************************************
    ' * Send the email
    ' *************************************************************************    
    objMail.Send

    ' *************************************************************************
    ' * if there are problems send a log message to console.
    ' *************************************************************************    
    if err.number <> 0 then
    
    ' *************************************************************************
    ' * Actual error log bit.
    ' *************************************************************************    
        subError "Mail failed to send to strEmail"
    
    end if

    ' *************************************************************************
    ' * Instance clean up. 
    ' *************************************************************************    
    set objMail = nothing

end sub